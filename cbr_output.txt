contextClass("aimCtx").
businessCaseClass("semNOTAMCASE").

hasParameter("contextClass","Parameter_Wtguju"). 
hasParameter("contextClass","Parameter_Wsnlbv"). 
hasParameter("contextClass","Parameter_Zotnjr"). 

parameter("Parameter_Wtguju").
parameter("Parameter_Wsnlbv").
parameter("Parameter_Zotnjr").

% -----------------------------------------------------------------------------
% DEFINING PARAMETERS, PARAMETER VALUES, CONTEXTS, AND DETpARAMvALUE
% -----------------------------------------------------------------------------
% Parameter values and their hierarchy
paramValue("Parameter_Wtguju","ParamValue_Vfuchv").paramValue("Parameter_Wtguju","ParamValue_Tylmxt").paramValue("Parameter_Wtguju","ParamValue_Srfikz").paramValue("Parameter_Wtguju","ParamValue_Zsdmns").paramValue("Parameter_Wtguju","ParamValue_Ivrbik").paramValue("Parameter_Wtguju","ParamValue_Ggrwdu").paramValue("Parameter_Wtguju","ParamValue_Rsvnwq").
paramValue("Parameter_Wsnlbv","ParamValue_Oyhlqq").paramValue("Parameter_Wsnlbv","ParamValue_Mznvjm").paramValue("Parameter_Wsnlbv","ParamValue_Ocucbu").paramValue("Parameter_Wsnlbv","ParamValue_Kborjl").paramValue("Parameter_Wsnlbv","ParamValue_Ipszpi").paramValue("Parameter_Wsnlbv","ParamValue_Lhegcn").paramValue("Parameter_Wsnlbv","ParamValue_Tqjouu").
paramValue("Parameter_Zotnjr","ParamValue_Ueanxf").paramValue("Parameter_Zotnjr","ParamValue_Cbynme").paramValue("Parameter_Zotnjr","ParamValue_Vcvpim").paramValue("Parameter_Zotnjr","ParamValue_Lzfdxv").paramValue("Parameter_Zotnjr","ParamValue_Cdazjl").paramValue("Parameter_Zotnjr","ParamValue_Chqmyo").paramValue("Parameter_Zotnjr","ParamValue_Omkmrj").
paramValue("Parameter_Wtguju","ParamValue_Vfuchv").paramValue("Parameter_Wtguju","ParamValue_Tylmxt").paramValue("Parameter_Wtguju","ParamValue_Srfikz").paramValue("Parameter_Wtguju","ParamValue_Zsdmns").paramValue("Parameter_Wtguju","ParamValue_Ivrbik").paramValue("Parameter_Wtguju","ParamValue_Ggrwdu").paramValue("Parameter_Wtguju","ParamValue_Rsvnwq").
paramValue("Parameter_Wsnlbv","ParamValue_Oyhlqq").paramValue("Parameter_Wsnlbv","ParamValue_Mznvjm").paramValue("Parameter_Wsnlbv","ParamValue_Ocucbu").paramValue("Parameter_Wsnlbv","ParamValue_Kborjl").paramValue("Parameter_Wsnlbv","ParamValue_Ipszpi").paramValue("Parameter_Wsnlbv","ParamValue_Lhegcn").paramValue("Parameter_Wsnlbv","ParamValue_Tqjouu").
paramValue("Parameter_Zotnjr","ParamValue_Ueanxf").paramValue("Parameter_Zotnjr","ParamValue_Cbynme").paramValue("Parameter_Zotnjr","ParamValue_Vcvpim").paramValue("Parameter_Zotnjr","ParamValue_Lzfdxv").paramValue("Parameter_Zotnjr","ParamValue_Cdazjl").paramValue("Parameter_Zotnjr","ParamValue_Chqmyo").paramValue("Parameter_Zotnjr","ParamValue_Omkmrj").

covers("ParamValue_Vfuchv","ParamValue_Tylmxt"). covers("ParamValue_Vfuchv","ParamValue_Srfikz"). covers("ParamValue_Vfuchv","ParamValue_Zsdmns"). covers("ParamValue_Vfuchv","ParamValue_Ivrbik"). covers("ParamValue_Vfuchv","ParamValue_Ggrwdu"). covers("ParamValue_Vfuchv","ParamValue_Rsvnwq"). 
covers("ParamValue_Oyhlqq","ParamValue_Mznvjm"). covers("ParamValue_Oyhlqq","ParamValue_Ocucbu"). covers("ParamValue_Oyhlqq","ParamValue_Kborjl"). covers("ParamValue_Oyhlqq","ParamValue_Ipszpi"). covers("ParamValue_Oyhlqq","ParamValue_Lhegcn"). covers("ParamValue_Oyhlqq","ParamValue_Tqjouu"). 
covers("ParamValue_Ueanxf","ParamValue_Cbynme"). covers("ParamValue_Ueanxf","ParamValue_Vcvpim"). covers("ParamValue_Ueanxf","ParamValue_Lzfdxv"). covers("ParamValue_Ueanxf","ParamValue_Cdazjl"). covers("ParamValue_Ueanxf","ParamValue_Chqmyo"). covers("ParamValue_Ueanxf","ParamValue_Omkmrj"). 
covers("ParamValue_Vfuchv","ParamValue_Tylmxt"). covers("ParamValue_Vfuchv","ParamValue_Srfikz"). covers("ParamValue_Vfuchv","ParamValue_Zsdmns"). covers("ParamValue_Vfuchv","ParamValue_Ivrbik"). covers("ParamValue_Vfuchv","ParamValue_Ggrwdu"). covers("ParamValue_Vfuchv","ParamValue_Rsvnwq"). 
covers("ParamValue_Oyhlqq","ParamValue_Mznvjm"). covers("ParamValue_Oyhlqq","ParamValue_Ocucbu"). covers("ParamValue_Oyhlqq","ParamValue_Kborjl"). covers("ParamValue_Oyhlqq","ParamValue_Ipszpi"). covers("ParamValue_Oyhlqq","ParamValue_Lhegcn"). covers("ParamValue_Oyhlqq","ParamValue_Tqjouu"). 
covers("ParamValue_Ueanxf","ParamValue_Cbynme"). covers("ParamValue_Ueanxf","ParamValue_Vcvpim"). covers("ParamValue_Ueanxf","ParamValue_Lzfdxv"). covers("ParamValue_Ueanxf","ParamValue_Cdazjl"). covers("ParamValue_Ueanxf","ParamValue_Chqmyo"). covers("ParamValue_Ueanxf","ParamValue_Omkmrj"). 

%Contexts
context("ctx0"). hasName("ctx0","ParamValue_Vfuchv_ParamValue_Mznvjm_ParamValue_Omkmrj"). hasModule("ctx0","module0"). hasContextClass("ctx0","aimCtx"). 
hasParamValue("ctx0","Parameter_Wtguju","ParamValue_Vfuchv"). hasParamValue("ctx0","Parameter_Wsnlbv","ParamValue_Mznvjm"). hasParamValue("ctx0","Parameter_Zotnjr","ParamValue_Omkmrj"). 
context("ctx1"). hasName("ctx1","ParamValue_Vfuchv_ParamValue_Kborjl_ParamValue_Cdazjl"). hasModule("ctx1","module1"). hasContextClass("ctx1","aimCtx"). 
hasParamValue("ctx1","Parameter_Wtguju","ParamValue_Vfuchv"). hasParamValue("ctx1","Parameter_Wsnlbv","ParamValue_Kborjl"). hasParamValue("ctx1","Parameter_Zotnjr","ParamValue_Cdazjl"). 
context("ctx2"). hasName("ctx2","ParamValue_Vfuchv_ParamValue_Mznvjm_ParamValue_Vcvpim"). hasModule("ctx2","module2"). hasContextClass("ctx2","aimCtx"). 
hasParamValue("ctx2","Parameter_Wtguju","ParamValue_Vfuchv"). hasParamValue("ctx2","Parameter_Wsnlbv","ParamValue_Mznvjm"). hasParamValue("ctx2","Parameter_Zotnjr","ParamValue_Vcvpim"). 
context("ctx3"). hasName("ctx3","ParamValue_Zsdmns_ParamValue_Oyhlqq_ParamValue_Omkmrj"). hasModule("ctx3","module3"). hasContextClass("ctx3","aimCtx"). 
hasParamValue("ctx3","Parameter_Wtguju","ParamValue_Zsdmns"). hasParamValue("ctx3","Parameter_Wsnlbv","ParamValue_Oyhlqq"). hasParamValue("ctx3","Parameter_Zotnjr","ParamValue_Omkmrj"). 
context("ctx4"). hasName("ctx4","ParamValue_Vfuchv_ParamValue_Ipszpi_ParamValue_Lzfdxv"). hasModule("ctx4","module4"). hasContextClass("ctx4","aimCtx"). 
hasParamValue("ctx4","Parameter_Wtguju","ParamValue_Vfuchv"). hasParamValue("ctx4","Parameter_Wsnlbv","ParamValue_Ipszpi"). hasParamValue("ctx4","Parameter_Zotnjr","ParamValue_Lzfdxv"). 
context("ctx5"). hasName("ctx5","ParamValue_Rsvnwq_ParamValue_Lhegcn_ParamValue_Lzfdxv"). hasModule("ctx5","module5"). hasContextClass("ctx5","aimCtx"). 
hasParamValue("ctx5","Parameter_Wtguju","ParamValue_Rsvnwq"). hasParamValue("ctx5","Parameter_Wsnlbv","ParamValue_Lhegcn"). hasParamValue("ctx5","Parameter_Zotnjr","ParamValue_Lzfdxv"). 
context("ctx6"). hasName("ctx6","ParamValue_Ivrbik_ParamValue_Ipszpi_ParamValue_Chqmyo"). hasModule("ctx6","module6"). hasContextClass("ctx6","aimCtx"). 
hasParamValue("ctx6","Parameter_Wtguju","ParamValue_Ivrbik"). hasParamValue("ctx6","Parameter_Wsnlbv","ParamValue_Ipszpi"). hasParamValue("ctx6","Parameter_Zotnjr","ParamValue_Chqmyo"). 
context("ctx7"). hasName("ctx7","ParamValue_Zsdmns_ParamValue_Ocucbu_ParamValue_Vcvpim"). hasModule("ctx7","module7"). hasContextClass("ctx7","aimCtx"). 
hasParamValue("ctx7","Parameter_Wtguju","ParamValue_Zsdmns"). hasParamValue("ctx7","Parameter_Wsnlbv","ParamValue_Ocucbu"). hasParamValue("ctx7","Parameter_Zotnjr","ParamValue_Vcvpim"). 
context("ctx8"). hasName("ctx8","ParamValue_Vfuchv_ParamValue_Lhegcn_ParamValue_Lzfdxv"). hasModule("ctx8","module8"). hasContextClass("ctx8","aimCtx"). 
hasParamValue("ctx8","Parameter_Wtguju","ParamValue_Vfuchv"). hasParamValue("ctx8","Parameter_Wsnlbv","ParamValue_Lhegcn"). hasParamValue("ctx8","Parameter_Zotnjr","ParamValue_Lzfdxv"). 
context("ctx9"). hasName("ctx9","ParamValue_Tylmxt_ParamValue_Tqjouu_ParamValue_Cbynme"). hasModule("ctx9","module9"). hasContextClass("ctx9","aimCtx"). 
hasParamValue("ctx9","Parameter_Wtguju","ParamValue_Tylmxt"). hasParamValue("ctx9","Parameter_Wsnlbv","ParamValue_Tqjouu"). hasParamValue("ctx9","Parameter_Zotnjr","ParamValue_Cbynme"). 

 % Determine Parameter Values
detParamValue(BC,"Parameter_Wtguju","Val") :- businessCase(BC), hasDescProp(BC,"DescProp_Rgizgy",Val).
detParamValue(BC,"Parameter_Wsnlbv","Val") :- businessCase(BC), hasDescProp(BC,"DescProp_Gjyqfy",Val).
detParamValue(BC,"Parameter_Zotnjr","Val") :- businessCase(BC), hasDescProp(BC,"DescProp_Hxapwq",Val).

businessCase("bc0"). hasDescProp("bc0", "DescProp_Rgizgy", "ParamValue_Tylmxt").
businessCase("bc0"). hasDescProp("bc0", "DescProp_Gjyqfy", "ParamValue_Kborjl").
businessCase("bc0"). hasDescProp("bc0", "DescProp_Hxapwq", "ParamValue_Vcvpim").

businessCase("bc1"). hasDescProp("bc1", "DescProp_Rgizgy", "ParamValue_Ggrwdu").
businessCase("bc1"). hasDescProp("bc1", "DescProp_Gjyqfy", "ParamValue_Kborjl").
businessCase("bc1"). hasDescProp("bc1", "DescProp_Hxapwq", "ParamValue_Ueanxf").

businessCase("bc2"). hasDescProp("bc2", "DescProp_Rgizgy", "ParamValue_Rsvnwq").
businessCase("bc2"). hasDescProp("bc2", "DescProp_Gjyqfy", "ParamValue_Ocucbu").
businessCase("bc2"). hasDescProp("bc2", "DescProp_Hxapwq", "ParamValue_Cdazjl").


% -----------------------------------------------------------------------------
% DERIVING RELATIONSHIPS OF PARAM VALUES AND CONTEXTS
% -----------------------------------------------------------------------------
% transitive and transitive-reflexive covers
tCovers(Pval,Cval) :- tCovers(Pval,X), covers(X,Cval).
tCovers(Pval,Cval) :- covers(Pval,Cval).
trCovers(Pval,Cval) :- tCovers(Pval,Cval). trCovers(Pval,Pval):- paramValue(_,Pval).

% Context Hierarchy
paramCover(P,C,Param):- hasParamValue(C,Param,Pval), hasParamValue(P,Param,Pval2), trCovers(Pval2,Pval).
notParamCover(C,P,Param):- context(C), hasContextClass(C,CtxCl), hasParameter(CtxCl,Param), context(P), not paramCover(C,P,Param).
ctxInherits(C,P) :- paramCover(P,C,_), not notParamCover(P,C,_).


% -----------------------------------------------------------------------------
% DETERMINE RELEVANT CONTEXTS AND THE MOST SPECIFIC RELEVANT CONTEXT
% -----------------------------------------------------------------------------
bcParamCover(BC,Ctx,Param) :- hasParamValue(Ctx,Param,PVal), detParamValue(BC,Param,PVal2), trCovers(PVal,PVal2).
notBcParamCover(BC,Ctx,Param) :- businessCase(BC), context(Ctx), hasContextClass(Ctx,CtxCl), hasParameter(CtxCl,Param), not bcParamCover(BC,Ctx,Param).
detRelevantCtxs(BC,Ctx) :- bcParamCover(BC,Ctx,X), not notBcParamCover(BC,Ctx,Y).

hasRelevantDescendant(BC,Ctx) :- detRelevantCtxs(BC,Ctx), detRelevantCtxs(BC,Ctx2), ctxInherits(Ctx2,Ctx), not w_ctxIdent(Ctx,Ctx2), Ctx!=Ctx2.
detMostSpecificCtx(BC,Ctx) :- detRelevantCtxs(BC,Ctx), not hasRelevantDescendant(BC,Ctx).

@output("detMostSpecificCtx"). @post("detMostSpecificCtx","orderby(1,2)").
@output("detRelevantCtxs"). @post("detRelevantCtxs","orderby(1,2)").

% -----------------------------------------------------------------------------
% WARNINGS
% -----------------------------------------------------------------------------
w_incompleteCtxSpec(C) :- parameter(P), context(C), not hasParamValue(C,P,_).
@output("w_incompleteCtxSpec").

ctxDiffParamValue(Ctx1,Ctx2) :- context(Ctx1), context(Ctx2), hasParamValue(Ctx1,P,PVal1), hasParamValue(Ctx2,P,PVal2), PVal1!=PVal2.
w_ctxIdent(Ctx1,Ctx2) :- context(Ctx1), context(Ctx2), not ctxDiffParamValue(Ctx1,Ctx2),Ctx1!=Ctx2.
@output("w_ctxIdent").

