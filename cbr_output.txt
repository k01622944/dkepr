contextClass("aimCtx").
businessCaseClass("semNOTAMCASE").

hasParameter("contextClass","Parameter_Scdfdn"). 
hasParameter("contextClass","Parameter_Lhzkiv"). 
hasParameter("contextClass","Parameter_Gpdyej"). 

parameter("Parameter_Scdfdn").
parameter("Parameter_Lhzkiv").
parameter("Parameter_Gpdyej").

% -----------------------------------------------------------------------------
% DEFINING PARAMETERS, PARAMETER VALUES, CONTEXTS, AND DETpARAMvALUE
% -----------------------------------------------------------------------------
% Parameter values and their hierarchy
paramValue("Parameter_Scdfdn","ParamValue_Dbxfhh").paramValue("Parameter_Scdfdn","ParamValue_Aeotjg").paramValue("Parameter_Scdfdn","ParamValue_Dxiyzq").paramValue("Parameter_Scdfdn","ParamValue_Heiyxn").paramValue("Parameter_Scdfdn","ParamValue_Vrgkxt").paramValue("Parameter_Scdfdn","ParamValue_Vmvgsh").paramValue("Parameter_Scdfdn","ParamValue_Ngaxuc").
paramValue("Parameter_Lhzkiv","ParamValue_Vuhcrt").paramValue("Parameter_Lhzkiv","ParamValue_Lwgtqz").paramValue("Parameter_Lhzkiv","ParamValue_Ztlxvi").paramValue("Parameter_Lhzkiv","ParamValue_Znfmjh").paramValue("Parameter_Lhzkiv","ParamValue_Jitbeb").paramValue("Parameter_Lhzkiv","ParamValue_Eifhyt").paramValue("Parameter_Lhzkiv","ParamValue_Vxqktg").
paramValue("Parameter_Gpdyej","ParamValue_Qxzvhf").paramValue("Parameter_Gpdyej","ParamValue_Ruukew").paramValue("Parameter_Gpdyej","ParamValue_Ctbrol").paramValue("Parameter_Gpdyej","ParamValue_Dktzdb").paramValue("Parameter_Gpdyej","ParamValue_Oynllr").paramValue("Parameter_Gpdyej","ParamValue_Oshvgs").paramValue("Parameter_Gpdyej","ParamValue_Ctdhor").
paramValue("Parameter_Scdfdn","ParamValue_Dbxfhh").paramValue("Parameter_Scdfdn","ParamValue_Aeotjg").paramValue("Parameter_Scdfdn","ParamValue_Dxiyzq").paramValue("Parameter_Scdfdn","ParamValue_Heiyxn").paramValue("Parameter_Scdfdn","ParamValue_Vrgkxt").paramValue("Parameter_Scdfdn","ParamValue_Vmvgsh").paramValue("Parameter_Scdfdn","ParamValue_Ngaxuc").
paramValue("Parameter_Lhzkiv","ParamValue_Vuhcrt").paramValue("Parameter_Lhzkiv","ParamValue_Lwgtqz").paramValue("Parameter_Lhzkiv","ParamValue_Ztlxvi").paramValue("Parameter_Lhzkiv","ParamValue_Znfmjh").paramValue("Parameter_Lhzkiv","ParamValue_Jitbeb").paramValue("Parameter_Lhzkiv","ParamValue_Eifhyt").paramValue("Parameter_Lhzkiv","ParamValue_Vxqktg").
paramValue("Parameter_Gpdyej","ParamValue_Qxzvhf").paramValue("Parameter_Gpdyej","ParamValue_Ruukew").paramValue("Parameter_Gpdyej","ParamValue_Ctbrol").paramValue("Parameter_Gpdyej","ParamValue_Dktzdb").paramValue("Parameter_Gpdyej","ParamValue_Oynllr").paramValue("Parameter_Gpdyej","ParamValue_Oshvgs").paramValue("Parameter_Gpdyej","ParamValue_Ctdhor").

covers("ParamValue_Dbxfhh","ParamValue_Aeotjg"). covers("ParamValue_Dbxfhh","ParamValue_Dxiyzq"). covers("ParamValue_Dbxfhh","ParamValue_Heiyxn"). covers("ParamValue_Dbxfhh","ParamValue_Vrgkxt"). covers("ParamValue_Dbxfhh","ParamValue_Vmvgsh"). covers("ParamValue_Dbxfhh","ParamValue_Ngaxuc"). 
covers("ParamValue_Vuhcrt","ParamValue_Lwgtqz"). covers("ParamValue_Vuhcrt","ParamValue_Ztlxvi"). covers("ParamValue_Vuhcrt","ParamValue_Znfmjh"). covers("ParamValue_Vuhcrt","ParamValue_Jitbeb"). covers("ParamValue_Vuhcrt","ParamValue_Eifhyt"). covers("ParamValue_Vuhcrt","ParamValue_Vxqktg"). 
covers("ParamValue_Qxzvhf","ParamValue_Ruukew"). covers("ParamValue_Qxzvhf","ParamValue_Ctbrol"). covers("ParamValue_Qxzvhf","ParamValue_Dktzdb"). covers("ParamValue_Qxzvhf","ParamValue_Oynllr"). covers("ParamValue_Qxzvhf","ParamValue_Oshvgs"). covers("ParamValue_Qxzvhf","ParamValue_Ctdhor"). 
covers("ParamValue_Dbxfhh","ParamValue_Aeotjg"). covers("ParamValue_Dbxfhh","ParamValue_Dxiyzq"). covers("ParamValue_Dbxfhh","ParamValue_Heiyxn"). covers("ParamValue_Dbxfhh","ParamValue_Vrgkxt"). covers("ParamValue_Dbxfhh","ParamValue_Vmvgsh"). covers("ParamValue_Dbxfhh","ParamValue_Ngaxuc"). 
covers("ParamValue_Vuhcrt","ParamValue_Lwgtqz"). covers("ParamValue_Vuhcrt","ParamValue_Ztlxvi"). covers("ParamValue_Vuhcrt","ParamValue_Znfmjh"). covers("ParamValue_Vuhcrt","ParamValue_Jitbeb"). covers("ParamValue_Vuhcrt","ParamValue_Eifhyt"). covers("ParamValue_Vuhcrt","ParamValue_Vxqktg"). 
covers("ParamValue_Qxzvhf","ParamValue_Ruukew"). covers("ParamValue_Qxzvhf","ParamValue_Ctbrol"). covers("ParamValue_Qxzvhf","ParamValue_Dktzdb"). covers("ParamValue_Qxzvhf","ParamValue_Oynllr"). covers("ParamValue_Qxzvhf","ParamValue_Oshvgs"). covers("ParamValue_Qxzvhf","ParamValue_Ctdhor"). 

%Contexts
context("ctx0"). hasName("ctx0","ParamValue_Ngaxuc_ParamValue_Vxqktg_ParamValue_Qxzvhf"). hasModule("ctx0","module0"). hasContextClass("ctx0","aimCtx"). 
hasParamValue("ctx0","Parameter_Scdfdn","ParamValue_Ngaxuc"). hasParamValue("ctx0","Parameter_Lhzkiv","ParamValue_Vxqktg"). hasParamValue("ctx0","Parameter_Gpdyej","ParamValue_Qxzvhf"). 
context("ctx1"). hasName("ctx1","ParamValue_Vmvgsh_ParamValue_Ztlxvi_ParamValue_Dktzdb"). hasModule("ctx1","module1"). hasContextClass("ctx1","aimCtx"). 
hasParamValue("ctx1","Parameter_Scdfdn","ParamValue_Vmvgsh"). hasParamValue("ctx1","Parameter_Lhzkiv","ParamValue_Ztlxvi"). hasParamValue("ctx1","Parameter_Gpdyej","ParamValue_Dktzdb"). 
context("ctx2"). hasName("ctx2","ParamValue_Heiyxn_ParamValue_Eifhyt_ParamValue_Ctbrol"). hasModule("ctx2","module2"). hasContextClass("ctx2","aimCtx"). 
hasParamValue("ctx2","Parameter_Scdfdn","ParamValue_Heiyxn"). hasParamValue("ctx2","Parameter_Lhzkiv","ParamValue_Eifhyt"). hasParamValue("ctx2","Parameter_Gpdyej","ParamValue_Ctbrol"). 
context("ctx3"). hasName("ctx3","ParamValue_Dxiyzq_ParamValue_Vuhcrt_ParamValue_Oynllr"). hasModule("ctx3","module3"). hasContextClass("ctx3","aimCtx"). 
hasParamValue("ctx3","Parameter_Scdfdn","ParamValue_Dxiyzq"). hasParamValue("ctx3","Parameter_Lhzkiv","ParamValue_Vuhcrt"). hasParamValue("ctx3","Parameter_Gpdyej","ParamValue_Oynllr"). 
context("ctx4"). hasName("ctx4","ParamValue_Dbxfhh_ParamValue_Jitbeb_ParamValue_Oshvgs"). hasModule("ctx4","module4"). hasContextClass("ctx4","aimCtx"). 
hasParamValue("ctx4","Parameter_Scdfdn","ParamValue_Dbxfhh"). hasParamValue("ctx4","Parameter_Lhzkiv","ParamValue_Jitbeb"). hasParamValue("ctx4","Parameter_Gpdyej","ParamValue_Oshvgs"). 
context("ctx5"). hasName("ctx5","ParamValue_Heiyxn_ParamValue_Lwgtqz_ParamValue_Ruukew"). hasModule("ctx5","module5"). hasContextClass("ctx5","aimCtx"). 
hasParamValue("ctx5","Parameter_Scdfdn","ParamValue_Heiyxn"). hasParamValue("ctx5","Parameter_Lhzkiv","ParamValue_Lwgtqz"). hasParamValue("ctx5","Parameter_Gpdyej","ParamValue_Ruukew"). 
context("ctx6"). hasName("ctx6","ParamValue_Vrgkxt_ParamValue_Znfmjh_ParamValue_Oshvgs"). hasModule("ctx6","module6"). hasContextClass("ctx6","aimCtx"). 
hasParamValue("ctx6","Parameter_Scdfdn","ParamValue_Vrgkxt"). hasParamValue("ctx6","Parameter_Lhzkiv","ParamValue_Znfmjh"). hasParamValue("ctx6","Parameter_Gpdyej","ParamValue_Oshvgs"). 
context("ctx7"). hasName("ctx7","ParamValue_Aeotjg_ParamValue_Jitbeb_ParamValue_Oynllr"). hasModule("ctx7","module7"). hasContextClass("ctx7","aimCtx"). 
hasParamValue("ctx7","Parameter_Scdfdn","ParamValue_Aeotjg"). hasParamValue("ctx7","Parameter_Lhzkiv","ParamValue_Jitbeb"). hasParamValue("ctx7","Parameter_Gpdyej","ParamValue_Oynllr"). 
context("ctx8"). hasName("ctx8","ParamValue_Dxiyzq_ParamValue_Znfmjh_ParamValue_Oynllr"). hasModule("ctx8","module8"). hasContextClass("ctx8","aimCtx"). 
hasParamValue("ctx8","Parameter_Scdfdn","ParamValue_Dxiyzq"). hasParamValue("ctx8","Parameter_Lhzkiv","ParamValue_Znfmjh"). hasParamValue("ctx8","Parameter_Gpdyej","ParamValue_Oynllr"). 
context("ctx9"). hasName("ctx9","ParamValue_Vmvgsh_ParamValue_Vxqktg_ParamValue_Ctdhor"). hasModule("ctx9","module9"). hasContextClass("ctx9","aimCtx"). 
hasParamValue("ctx9","Parameter_Scdfdn","ParamValue_Vmvgsh"). hasParamValue("ctx9","Parameter_Lhzkiv","ParamValue_Vxqktg"). hasParamValue("ctx9","Parameter_Gpdyej","ParamValue_Ctdhor"). 

 % Determine Parameter Values
detParamValue(BC,"Parameter_Scdfdn","Val") :- businessCase(BC), hasDescProp(BC,"DescProp_Tgczxe",Val).
detParamValue(BC,"Parameter_Lhzkiv","Val") :- businessCase(BC), hasDescProp(BC,"DescProp_Gaknlm",Val).
detParamValue(BC,"Parameter_Gpdyej","Val") :- businessCase(BC), hasDescProp(BC,"DescProp_Lstlge",Val).

businessCase("bc0"). hasDescProp("bc0", "DescProp_Tgczxe", "ParamValue_Ngaxuc").
businessCase("bc0"). hasDescProp("bc0", "DescProp_Gaknlm", "ParamValue_Znfmjh").
businessCase("bc0"). hasDescProp("bc0", "DescProp_Lstlge", "ParamValue_Ctbrol").

businessCase("bc1"). hasDescProp("bc1", "DescProp_Tgczxe", "ParamValue_Dxiyzq").
businessCase("bc1"). hasDescProp("bc1", "DescProp_Gaknlm", "ParamValue_Znfmjh").
businessCase("bc1"). hasDescProp("bc1", "DescProp_Lstlge", "ParamValue_Ctdhor").

businessCase("bc2"). hasDescProp("bc2", "DescProp_Tgczxe", "ParamValue_Aeotjg").
businessCase("bc2"). hasDescProp("bc2", "DescProp_Gaknlm", "ParamValue_Znfmjh").
businessCase("bc2"). hasDescProp("bc2", "DescProp_Lstlge", "ParamValue_Dktzdb").


% -----------------------------------------------------------------------------
% DERIVING RELATIONSHIPS OF PARAM VALUES AND CONTEXTS
% -----------------------------------------------------------------------------
% transitive and transitive-reflexive covers
tCovers(Pval,Cval) :- tCovers(Pval,X), covers(X,Cval).
tCovers(Pval,Cval) :- covers(Pval,Cval).
trCovers(Pval,Cval) :- tCovers(Pval,Cval). trCovers(Pval,Pval):- paramValue(_,Pval).

% Context Hierarchy
paramCover(P,C,Param):- hasParamValue(C,Param,Pval), hasParamValue(P,Param,Pval2), trCovers(Pval2,Pval).
notParamCover(C,P,Param):- context(C), hasContextClass(C,CtxCl), hasParameter(CtxCl,Param), context(P), not paramCover(C,P,Param).
ctxInherits(C,P) :- paramCover(P,C,_), not notParamCover(P,C,_).


% -----------------------------------------------------------------------------
% DETERMINE RELEVANT CONTEXTS AND THE MOST SPECIFIC RELEVANT CONTEXT
% -----------------------------------------------------------------------------
bcParamCover(BC,Ctx,Param) :- hasParamValue(Ctx,Param,PVal), detParamValue(BC,Param,PVal2), trCovers(PVal,PVal2).
notBcParamCover(BC,Ctx,Param) :- businessCase(BC), context(Ctx), hasContextClass(Ctx,CtxCl), hasParameter(CtxCl,Param), not bcParamCover(BC,Ctx,Param).
detRelevantCtxs(BC,Ctx) :- bcParamCover(BC,Ctx,X), not notBcParamCover(BC,Ctx,Y).

hasRelevantDescendant(BC,Ctx) :- detRelevantCtxs(BC,Ctx), detRelevantCtxs(BC,Ctx2), ctxInherits(Ctx2,Ctx), not w_ctxIdent(Ctx,Ctx2), Ctx!=Ctx2.
detMostSpecificCtx(BC,Ctx) :- detRelevantCtxs(BC,Ctx), not hasRelevantDescendant(BC,Ctx).

@output("detMostSpecificCtx"). @post("detMostSpecificCtx","orderby(1,2)").
@output("detRelevantCtxs"). @post("detRelevantCtxs","orderby(1,2)").

% -----------------------------------------------------------------------------
% WARNINGS
% -----------------------------------------------------------------------------
w_incompleteCtxSpec(C) :- parameter(P), context(C), not hasParamValue(C,P,_).
@output("w_incompleteCtxSpec").

ctxDiffParamValue(Ctx1,Ctx2) :- context(Ctx1), context(Ctx2), hasParamValue(Ctx1,P,PVal1), hasParamValue(Ctx2,P,PVal2), PVal1!=PVal2.
w_ctxIdent(Ctx1,Ctx2) :- context(Ctx1), context(Ctx2), not ctxDiffParamValue(Ctx1,Ctx2),Ctx1!=Ctx2.
@output("w_ctxIdent").

